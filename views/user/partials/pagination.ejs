<% if (totalPages && totalPages > 1) { %>
  <nav class="mt-4">
    <ul class="pagination justify-content-center" id="pagination-container">
      <!-- Previous Button -->
      <li class="page-item <%= currentPage === 1 ? 'disabled' : '' %>">
        <a class="page-link pagination-btn <%= currentPage === 1 ? 'disabled-btn' : '' %>"
           href="#"
           data-page="<%= currentPage - 1 %>"
           <%= currentPage === 1 ? 'tabindex="-1" aria-disabled="true"' : '' %>>
          <i class="bi bi-chevron-left"></i>
        </a>
      </li>

      <!-- Page Numbers -->
      <% for (let i = 1; i <= totalPages; i++) { %>
        <li class="page-item <%= i === currentPage ? 'active' : '' %>">
          <a class="page-link pagination-btn" href="#" data-page="<%= i %>"><%= i %></a>
        </li>
      <% } %>

      <!-- Next Button -->
      <li class="page-item <%= currentPage === totalPages ? 'disabled' : '' %>">
        <a class="page-link pagination-btn <%= currentPage === totalPages ? 'disabled-btn' : '' %>"
           href="#"
           data-page="<%= currentPage + 1 %>"
           <%= currentPage === totalPages ? 'tabindex="-1" aria-disabled="true"' : '' %>>
          <i class="bi bi-chevron-right"></i>
        </a>
      </li>
    </ul>
  </nav>

  <!-- ✅ SQUARE BUTTON PAGINATION STYLES (matching Image 2) -->
  <style>
    .pagination {
      display: flex;
      gap: 6px;
      justify-content: center;
      margin-bottom: 0;
    }

    .pagination .page-item {
      margin: 0;
    }

    /* ✅ SQUARE BUTTONS: All pagination buttons are square */
    .pagination .page-link {
      width: 40px;
      height: 40px;
      padding: 0;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 500;
      text-decoration: none;
      color: #333;
      background-color: #fff;
      border: 1px solid #ddd;
      transition: all 0.2s ease;
    }

    /* ✅ RED HOVER: Red hover effect for non-active buttons */
    .pagination .page-link:hover:not(.disabled-btn) {
      background-color: #dc3545 !important;
      border-color: #dc3545 !important;
      color: #fff !important;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);
    }

    /* ✅ BLACK ACTIVE: Black background for active page */
    .pagination .page-item.active .page-link {
      background-color: #000 !important;
      border-color: #000 !important;
      color: #fff !important;
      font-weight: 600;
    }

    /* ✅ ACTIVE NO HOVER: Active page doesn't change on hover */
    .pagination .page-item.active .page-link:hover {
      background-color: #000 !important;
      border-color: #000 !important;
      color: #fff !important;
      transform: none;
      box-shadow: none;
    }

    /* ✅ DISABLED STATE: Muted appearance for disabled buttons */
    .pagination .page-item.disabled .page-link,
    .pagination .page-link.disabled-btn {
      color: #adb5bd !important;
      background-color: #f8f9fa !important;
      border-color: #dee2e6 !important;
      cursor: not-allowed;
      opacity: 0.6;
      pointer-events: none;
    }

    /* ✅ DISABLED NO HOVER: Disabled buttons don't change on hover */
    .pagination .disabled-btn:hover,
    .pagination .page-item.disabled .page-link:hover {
      background-color: #f8f9fa !important;
      border-color: #dee2e6 !important;
      color: #adb5bd !important;
      transform: none !important;
      box-shadow: none !important;
    }

    /* ✅ ICON STYLING: Consistent arrow icon appearance */
    .pagination .page-link i {
      font-size: 14px;
      line-height: 1;
    }

    /* ✅ FOCUS STATES: Accessibility improvements */
    .pagination .page-link:focus {
      outline: 2px solid #dc3545;
      outline-offset: 2px;
      box-shadow: none;
    }

    .pagination .page-item.active .page-link:focus {
      outline: 2px solid #000;
    }

    /* ✅ RESPONSIVE: Mobile optimizations */
    @media (max-width: 576px) {
      .pagination {
        gap: 4px;
      }
      
      .pagination .page-link {
        width: 36px;
        height: 36px;
        font-size: 14px;
      }

      .pagination .page-link i {
        font-size: 12px;
      }
    }
  </style>

  <!-- Enhanced Pagination JavaScript -->
  <script>
    document.addEventListener('click', function (e) {
      const target = e.target.closest('.page-link');
      if (!target || !target.dataset.page || target.classList.contains('disabled-btn')) return;

      e.preventDefault();
      const page = parseInt(target.dataset.page);

      // Validate page number
      if (isNaN(page) || page < 1 || page > <%- totalPages %>) return;

      // Call the fetch function if it exists
      if (typeof fetchCallback === 'function') {
        fetchCallback(page);
      } else if (typeof window.paginationCallback === 'function') {
        window.paginationCallback(page);
      } else {
        console.warn('No pagination callback function found');
      }
    });

    // Add keyboard navigation
    document.addEventListener('keydown', function(e) {
      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;

      const currentPage = <%- currentPage %>;
      const totalPages = <%- totalPages %>;

      if (e.key === 'ArrowLeft' && currentPage > 1) {
        e.preventDefault();
        if (typeof fetchCallback === 'function') {
          fetchCallback(currentPage - 1);
        } else if (typeof window.paginationCallback === 'function') {
          window.paginationCallback(currentPage - 1);
        }
      } else if (e.key === 'ArrowRight' && currentPage < totalPages) {
        e.preventDefault();
        if (typeof fetchCallback === 'function') {
          fetchCallback(currentPage + 1);
        } else if (typeof window.paginationCallback === 'function') {
          window.paginationCallback(currentPage + 1);
        }
      }
    });
  </script>
<% } %>
